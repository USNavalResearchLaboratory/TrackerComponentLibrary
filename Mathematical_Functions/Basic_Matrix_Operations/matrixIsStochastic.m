function boolVal=matrixIsStochastic(A,stochType,tolVal)%%MATRIXISSTOCHASTIC Determine whether a matrix is a stochastic matrix.%       Transition matrices used in Markov chain models are right stochastic%       matrices. A matrix is right stochastic if it is square, all elements are%       within the range of [0,1] and all of the rows sum to 1. It is left%       stochastic if all the columns sum to 1. It is doubly stochastic if both%       rows and colums sum to 1. Rectangular and complex matrices are not%       stochastic in any manner.%%INPUTS: A A matrix.% stochType An optional parameter indicating which type of stochasticness will%          be tested. Possible values are:%          0 Right stochastic (the default if omitted or an empty matrix is%            passed).%          1 Left stochastic.%          2 Doubly stochastic.%   tolVal When dealing with floating point numbers, one cannot compare directly%          to zero. This is the tolerance to use. The default if omitted or an%          empty matrix is passed is 16*log2(numRows)*eps(), where numrows is%          the number of rows in A.%%OUTPUTS: boolVal This is true if the matrix is stochastic and false otherwise.%%EXAMPLE:%We give an example of stochastic and non-stochastic matrices.% A=rand(100,100);% isStoch1=matrixIsStochastic(A)%This will be false.% A=bsxfun(@rdivide,A,sum(A,2));% isStoch2=matrixIsStochastic(A)%This will be true.%% isDoublyStoch1=matrixIsStochastic(A,2)%This will be false.% isDoublyStoch2=matrixIsStochastic(eye(100),2)%This will be true.%%August 2020 David F. Crouse, Naval Research Laboratory, Washington D.C.%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.if(nargin<3||isempty(tolVal))    maxRowCol=length(A);    %A heuristic value.    tolVal=16*log2(maxRowCol)*eps();endif(nargin<2||isempty(stochType))    stochType=0;%Right stochastic matrix.endif(~isreal(A)||isempty(A)||size(A,1)~=size(A,2)||~ismatrix(A)||any(A(:)<0)||any(A(:)>1))    boolVal=false;    return;endswitch(stochType)    case 0%Right stochastic matrix.        boolVal=all(abs(sum(A,2)-1)<=tolVal);    case 1%Left stochastic matrix.        boolVal=all(abs(sum(A,1)-1)<=tolVal);    case 2%Doubly stochastic matrix.        boolVal=all(abs(sum(A,1)-1)<=tolVal)&&all(abs(sum(A,2)-1)<=tolVal);    otherwise        error('Unknown stochType specified');endend%LICENSE:%%The source code is in the public domain and not licensed or under%copyright. The information and software may be used freely by the public.%As required by 17 U.S.C. 403, third parties producing copyrighted works%consisting predominantly of the material produced by U.S. government%agencies must provide notice with such work(s) identifying the U.S.%Government material incorporated and stating that such material is not%subject to copyright protection.%%Derived works shall not identify themselves in a manner that implies an%endorsement by or an affiliation with the Naval Research Laboratory.%%RECIPIENT BEARS ALL RISK RELATING TO QUALITY AND PERFORMANCE OF THE%SOFTWARE AND ANY RELATED MATERIALS, AND AGREES TO INDEMNIFY THE NAVAL%RESEARCH LABORATORY FOR ALL THIRD-PARTY CLAIMS RESULTING FROM THE ACTIONS%OF RECIPIENT IN THE USE OF THE SOFTWARE.