function [xi,w]=twentyFirstOrder2DCubPoints()
%%TWENTYFIRSTORDER2DCUBPOINTS Generate twenty-first-order cubature points
%               for integration over a 2-dimensional cube with bounds of 
%               (-1,-1), (-1,1), (1,1), and (1,-1).
%
%INPUTS: None
%
%OUTPUTS: xi This is a 2XnumCubPoints set of points for the standard
%            square.
%          w A 1XnumCubPoints set of cubature weights. This sums to the
%            volume of the standard square (4).
%
%This function implements the points given in [1] (85 points).
%
%EXAMPLE:
%We compare a 20th-order moment computed using these cubature points
%to one computed using monomialIntCube (a 21st order moment would have just
%been 0). The results are the same within typical finite precision limits.
% [xi,w]=twentyFirstOrder2DCubPoints();
% alpha=[10;10];
% theMoment=findMomentFromSamp(alpha,xi,w);
% intVal=monomialIntCube(alpha);
% RelErr=(theMoment-intVal)/intVal
%
%REFERENCES:
%[1] F. D. Witherden and P. E. Vincent, "On the identification of symmetric
%    quadrature rules for finite element methods," Computer and Mathematics
%    with Applications, vol. 69, no. 10, pp. 1232-1241, May 2015.
%
%October 2022 David F. Crouse, Naval Research Laboratory, Washington D.C.
%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.

M=[                                      0,                                           0,    0.13519284035614282527922840385434746149;
  0.47335107435822415202690901838844666219,                                           0,     0.1067941587859403825037542148829566842;
                                         0,    0.47335107435822415202690901838844666219,     0.1067941587859403825037542148829566842;
 -0.47335107435822415202690901838844666219,                                           0,     0.1067941587859403825037542148829566842;
                                         0,  -0.47335107435822415202690901838844666219,     0.1067941587859403825037542148829566842;
  0.83527842975586830160520893009495292054,                                           0,   0.066257208004944385159031059020122440339;
                                         0,    0.83527842975586830160520893009495292054,   0.066257208004944385159031059020122440339;
 -0.83527842975586830160520893009495292054,                                           0,   0.066257208004944385159031059020122440339;
                                         0,   -0.83527842975586830160520893009495292054,   0.066257208004944385159031059020122440339;
   0.2573719006072289819053755213317636919,     0.2573719006072289819053755213317636919,    0.11988448364634046970472217835662908028;
   0.2573719006072289819053755213317636919,    -0.2573719006072289819053755213317636919,    0.11988448364634046970472217835662908028;
  -0.2573719006072289819053755213317636919,     0.2573719006072289819053755213317636919,    0.11988448364634046970472217835662908028;
  -0.2573719006072289819053755213317636919,    -0.2573719006072289819053755213317636919,    0.11988448364634046970472217835662908028;
  0.96333783211562335381484352624945730322,    0.96333783211562335381484352624945730322,  0.0082294612892200088282217117254895783997;
  0.96333783211562335381484352624945730322,   -0.96333783211562335381484352624945730322,  0.0082294612892200088282217117254895783997;
 -0.96333783211562335381484352624945730322,    0.96333783211562335381484352624945730322,  0.0082294612892200088282217117254895783997;
 -0.96333783211562335381484352624945730322,   -0.96333783211562335381484352624945730322,  0.0082294612892200088282217117254895783997;
  0.86245192537965155140267607631968215083,    0.86245192537965155140267607631968215083,   0.030603640928775651038141155704768806683;
  0.86245192537965155140267607631968215083,   -0.86245192537965155140267607631968215083,   0.030603640928775651038141155704768806683;
 -0.86245192537965155140267607631968215083,    0.86245192537965155140267607631968215083,   0.030603640928775651038141155704768806683;
 -0.86245192537965155140267607631968215083,   -0.86245192537965155140267607631968215083,   0.030603640928775651038141155704768806683;
  0.49689796251934570364793617005129236026,    0.49689796251934570364793617005129236026,   0.096791791893595210842497711127833756611;
  0.49689796251934570364793617005129236026,   -0.49689796251934570364793617005129236026,   0.096791791893595210842497711127833756611;
 -0.49689796251934570364793617005129236026,    0.49689796251934570364793617005129236026,   0.096791791893595210842497711127833756611;
 -0.49689796251934570364793617005129236026,   -0.49689796251934570364793617005129236026,   0.096791791893595210842497711127833756611;
  0.70433217519540056955932591780080720749,    0.70433217519540056955932591780080720749,   0.061516341481316561201749944009961586508;
  0.70433217519540056955932591780080720749,   -0.70433217519540056955932591780080720749,   0.061516341481316561201749944009961586508;
 -0.70433217519540056955932591780080720749,    0.70433217519540056955932591780080720749,   0.061516341481316561201749944009961586508;
 -0.70433217519540056955932591780080720749,   -0.70433217519540056955932591780080720749,   0.061516341481316561201749944009961586508;
  0.24187818547670197670997054949192246819,    0.67414621995531773950245618191533516236,   0.086728499513208224903936696999552926752;
  0.67414621995531773950245618191533516236,    0.24187818547670197670997054949192246819,   0.086728499513208224903936696999552926752;
  0.24187818547670197670997054949192246819,   -0.67414621995531773950245618191533516236,   0.086728499513208224903936696999552926752;
 -0.67414621995531773950245618191533516236,    0.24187818547670197670997054949192246819,   0.086728499513208224903936696999552926752;
 -0.24187818547670197670997054949192246819,    0.67414621995531773950245618191533516236,   0.086728499513208224903936696999552926752;
  0.67414621995531773950245618191533516236,   -0.24187818547670197670997054949192246819,   0.086728499513208224903936696999552926752;
 -0.24187818547670197670997054949192246819,   -0.67414621995531773950245618191533516236,   0.086728499513208224903936696999552926752;
 -0.67414621995531773950245618191533516236,   -0.24187818547670197670997054949192246819,   0.086728499513208224903936696999552926752;
  0.48015696631279513715726389107913072158,    0.82464737527092073827881221191700729562,   0.055879117404127348063047858204117827292;
  0.82464737527092073827881221191700729562,    0.48015696631279513715726389107913072158,   0.055879117404127348063047858204117827292;
  0.48015696631279513715726389107913072158,   -0.82464737527092073827881221191700729562,   0.055879117404127348063047858204117827292;
 -0.82464737527092073827881221191700729562,    0.48015696631279513715726389107913072158,   0.055879117404127348063047858204117827292;
 -0.48015696631279513715726389107913072158,    0.82464737527092073827881221191700729562,   0.055879117404127348063047858204117827292;
  0.82464737527092073827881221191700729562,   -0.48015696631279513715726389107913072158,   0.055879117404127348063047858204117827292;
 -0.48015696631279513715726389107913072158,   -0.82464737527092073827881221191700729562,   0.055879117404127348063047858204117827292;
 -0.82464737527092073827881221191700729562,   -0.48015696631279513715726389107913072158,   0.055879117404127348063047858204117827292;
  0.93224193592175396207500211941993080129,    0.27069918410166491089101469370373344757,   0.037128827440913817653330718954876960924;
  0.27069918410166491089101469370373344757,    0.93224193592175396207500211941993080129,   0.037128827440913817653330718954876960924;
  0.93224193592175396207500211941993080129,   -0.27069918410166491089101469370373344757,   0.037128827440913817653330718954876960924;
 -0.27069918410166491089101469370373344757,    0.93224193592175396207500211941993080129,   0.037128827440913817653330718954876960924;
 -0.93224193592175396207500211941993080129,    0.27069918410166491089101469370373344757,   0.037128827440913817653330718954876960924;
  0.27069918410166491089101469370373344757,   -0.93224193592175396207500211941993080129,   0.037128827440913817653330718954876960924;
 -0.93224193592175396207500211941993080129,   -0.27069918410166491089101469370373344757,   0.037128827440913817653330718954876960924;
 -0.27069918410166491089101469370373344757,   -0.93224193592175396207500211941993080129,   0.037128827440913817653330718954876960924;
  0.93490232582401054613354438740771124115,    0.67503956743707526937208896355984125883,   0.028775600851020531767579367626940765984;
  0.67503956743707526937208896355984125883,    0.93490232582401054613354438740771124115,   0.028775600851020531767579367626940765984;
  0.93490232582401054613354438740771124115,   -0.67503956743707526937208896355984125883,   0.028775600851020531767579367626940765984;
 -0.67503956743707526937208896355984125883,    0.93490232582401054613354438740771124115,   0.028775600851020531767579367626940765984;
 -0.93490232582401054613354438740771124115,    0.67503956743707526937208896355984125883,   0.028775600851020531767579367626940765984;
  0.67503956743707526937208896355984125883,   -0.93490232582401054613354438740771124115,   0.028775600851020531767579367626940765984;
 -0.93490232582401054613354438740771124115,   -0.67503956743707526937208896355984125883,   0.028775600851020531767579367626940765984;
 -0.67503956743707526937208896355984125883,   -0.93490232582401054613354438740771124115,   0.028775600851020531767579367626940765984;
  0.99045546752952415272197458895882111757,    0.48891625117716687937811887553934444444,   0.011509520442493167578261138308188460848;
  0.48891625117716687937811887553934444444,    0.99045546752952415272197458895882111757,   0.011509520442493167578261138308188460848;
  0.99045546752952415272197458895882111757,   -0.48891625117716687937811887553934444444,   0.011509520442493167578261138308188460848;
 -0.48891625117716687937811887553934444444,    0.99045546752952415272197458895882111757,   0.011509520442493167578261138308188460848;
 -0.99045546752952415272197458895882111757,    0.48891625117716687937811887553934444444,   0.011509520442493167578261138308188460848;
  0.48891625117716687937811887553934444444,   -0.99045546752952415272197458895882111757,   0.011509520442493167578261138308188460848;
 -0.99045546752952415272197458895882111757,   -0.48891625117716687937811887553934444444,   0.011509520442493167578261138308188460848;
 -0.48891625117716687937811887553934444444,   -0.99045546752952415272197458895882111757,   0.011509520442493167578261138308188460848;
  0.83113524597590138585974389212898407353,    0.98896061138657239166243578378631145048,  0.0075284821304016457091249399363317448912;
  0.98896061138657239166243578378631145048,    0.83113524597590138585974389212898407353,  0.0075284821304016457091249399363317448912;
  0.83113524597590138585974389212898407353,   -0.98896061138657239166243578378631145048,  0.0075284821304016457091249399363317448912;
 -0.98896061138657239166243578378631145048,    0.83113524597590138585974389212898407353,  0.0075284821304016457091249399363317448912;
 -0.83113524597590138585974389212898407353,    0.98896061138657239166243578378631145048,  0.0075284821304016457091249399363317448912;
  0.98896061138657239166243578378631145048,   -0.83113524597590138585974389212898407353,  0.0075284821304016457091249399363317448912;
 -0.83113524597590138585974389212898407353,   -0.98896061138657239166243578378631145048,  0.0075284821304016457091249399363317448912;
 -0.98896061138657239166243578378631145048,   -0.83113524597590138585974389212898407353,  0.0075284821304016457091249399363317448912;
 0.091469600922291296668443828573471880948,    0.98401714848959892866013755872564589893,   0.010512304158251076525756742074316914114;
  0.98401714848959892866013755872564589893,   0.091469600922291296668443828573471880948,   0.010512304158251076525756742074316914114;
 0.091469600922291296668443828573471880948,   -0.98401714848959892866013755872564589893,   0.010512304158251076525756742074316914114;
 -0.98401714848959892866013755872564589893,   0.091469600922291296668443828573471880948,   0.010512304158251076525756742074316914114;
-0.091469600922291296668443828573471880948,    0.98401714848959892866013755872564589893,   0.010512304158251076525756742074316914114;
  0.98401714848959892866013755872564589893,  -0.091469600922291296668443828573471880948,   0.010512304158251076525756742074316914114;
-0.091469600922291296668443828573471880948,   -0.98401714848959892866013755872564589893,   0.010512304158251076525756742074316914114;
 -0.98401714848959892866013755872564589893,  -0.091469600922291296668443828573471880948,   0.010512304158251076525756742074316914114];

w=M(:,3);
xi=M(:,1:2)';

end

%LICENSE:
%
%The source code is in the public domain and not licensed or under
%copyright. The information and software may be used freely by the public.
%As required by 17 U.S.C. 403, third parties producing copyrighted works
%consisting predominantly of the material produced by U.S. government
%agencies must provide notice with such work(s) identifying the U.S.
%Government material incorporated and stating that such material is not
%subject to copyright protection.
%
%Derived works shall not identify themselves in a manner that implies an
%endorsement by or an affiliation with the Naval Research Laboratory.
%
%RECIPIENT BEARS ALL RISK RELATING TO QUALITY AND PERFORMANCE OF THE
%SOFTWARE AND ANY RELATED MATERIALS, AND AGREES TO INDEMNIFY THE NAVAL
%RESEARCH LABORATORY FOR ALL THIRD-PARTY CLAIMS RESULTING FROM THE ACTIONS
%OF RECIPIENT IN THE USE OF THE SOFTWARE.
