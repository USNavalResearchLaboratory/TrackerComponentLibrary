function [xi,w]=tenthOrderPyramidCubPoints()
%%TENTHORDERPYRAMIDCUBPOINTS Generate tenth-order cubature points for
%  integration over a 3-dimensional pyramid with a square base with the
%  peak vertex at (0,0,1) and the base vertices at (1,-1,-1), (-1,-1,-1),
%  (-1,1,-1), and (1,1,-1).
% 
%INPUTS: None
%
%OUTPUTS: xi This is a 3XnumCubPoints set of points for the standard
%            square pyramid.
%          w A 1XnumCubPoints set of cubature weights. This sums to the
%            volume of the standard square pyramid (8/3).
%
%This function implements the points given in [1] (83 points).
%
%EXAMPLE:
%We compare a 10th-order moment computed using these cubature points
%to one computed using monomialIntPyramid. The results are the same within
%typical finite precision limits.
% [xi,w]=tenthOrderPyramidCubPoints();
% alpha=[4;2;4];
% theMoment=findMomentFromSamp(alpha,xi,w);
% intVal=monomialIntPyramid(alpha);
% RelErr=(theMoment-intVal)/intVal
%
%REFERENCES:
%[1] F. D. Witherden and P. E. Vincent, "On the identification of symmetric
%    quadrature rules for finite element methods," Computer and Mathematics
%    with Applications, vol. 69, no. 10, pp. 1232-1241, May 2015.
%
%October 2022 David F. Crouse, Naval Research Laboratory, Washington D.C.
%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.

M=[                                      0,                                           0,     0.8335915635582545504216363089082427512,  0.0064032713667237888900352396740754404729;
                                         0,                                           0,   -0.29772638731929483125782053014294599572,    0.12510914109270313689497865562091419825;
                                         0,                                           0,    0.48382713592659987946255767367350514622,   0.026257761996077744884993081945201819617;
   0.9211301560146403583275192188149101662,                                           0,   -0.87367680544017104618678473155554592542,   0.015139712847816799484708864305781950367;
                                         0,     0.9211301560146403583275192188149101662,   -0.87367680544017104618678473155554592542,   0.015139712847816799484708864305781950367;
  -0.9211301560146403583275192188149101662,                                           0,   -0.87367680544017104618678473155554592542,   0.015139712847816799484708864305781950367;
                                         0,    -0.9211301560146403583275192188149101662,   -0.87367680544017104618678473155554592542,   0.015139712847816799484708864305781950367;
  0.45469488442525374190737620014752106622,                                           0,   -0.64653917767653518703751426296454346724,    0.10992335931150491339794381086452639803;
                                         0,    0.45469488442525374190737620014752106622,   -0.64653917767653518703751426296454346724,    0.10992335931150491339794381086452639803;
 -0.45469488442525374190737620014752106622,                                           0,   -0.64653917767653518703751426296454346724,    0.10992335931150491339794381086452639803;
                                         0,   -0.45469488442525374190737620014752106622,   -0.64653917767653518703751426296454346724,    0.10992335931150491339794381086452639803;
  0.34954698449670665618703426052652270092,                                           0,    0.20418762141582796229356027682309379013,   0.024556675381417956733986284061921577306;
                                         0,    0.34954698449670665618703426052652270092,    0.20418762141582796229356027682309379013,   0.024556675381417956733986284061921577306;
 -0.34954698449670665618703426052652270092,                                           0,    0.20418762141582796229356027682309379013,   0.024556675381417956733986284061921577306;
                                         0,   -0.34954698449670665618703426052652270092,    0.20418762141582796229356027682309379013,   0.024556675381417956733986284061921577306;
   0.4036909359989290549941040384972850952,     0.4036909359989290549941040384972850952,   0.054098939536306234614681587161827868581,   0.018849056440184169335496436007427270559;
   0.4036909359989290549941040384972850952,    -0.4036909359989290549941040384972850952,   0.054098939536306234614681587161827868581,   0.018849056440184169335496436007427270559;
  -0.4036909359989290549941040384972850952,     0.4036909359989290549941040384972850952,   0.054098939536306234614681587161827868581,   0.018849056440184169335496436007427270559;
  -0.4036909359989290549941040384972850952,    -0.4036909359989290549941040384972850952,   0.054098939536306234614681587161827868581,   0.018849056440184169335496436007427270559;
  0.37146089090647414146733508749634017582,    0.37146089090647414146733508749634017582,   -0.30177911620290173994768222380627364654,   0.079548495536999982380261599863958558798;
  0.37146089090647414146733508749634017582,   -0.37146089090647414146733508749634017582,   -0.30177911620290173994768222380627364654,   0.079548495536999982380261599863958558798;
 -0.37146089090647414146733508749634017582,    0.37146089090647414146733508749634017582,   -0.30177911620290173994768222380627364654,   0.079548495536999982380261599863958558798;
 -0.37146089090647414146733508749634017582,   -0.37146089090647414146733508749634017582,   -0.30177911620290173994768222380627364654,   0.079548495536999982380261599863958558798;
  0.29959799664341220986603563452809915211,    0.29959799664341220986603563452809915211,   -0.98613205424907319746460559817869321699,   0.015653314138178086543067828035606638277;
  0.29959799664341220986603563452809915211,   -0.29959799664341220986603563452809915211,   -0.98613205424907319746460559817869321699,   0.015653314138178086543067828035606638277;
 -0.29959799664341220986603563452809915211,    0.29959799664341220986603563452809915211,   -0.98613205424907319746460559817869321699,   0.015653314138178086543067828035606638277;
 -0.29959799664341220986603563452809915211,   -0.29959799664341220986603563452809915211,   -0.98613205424907319746460559817869321699,   0.015653314138178086543067828035606638277;
  0.15822625455417853696460187646671225705,    0.15822625455417853696460187646671225705,    0.55052863586639312904708979516957590328,    0.01321164115938370158671751695816318467;
  0.15822625455417853696460187646671225705,   -0.15822625455417853696460187646671225705,    0.55052863586639312904708979516957590328,    0.01321164115938370158671751695816318467;
 -0.15822625455417853696460187646671225705,    0.15822625455417853696460187646671225705,    0.55052863586639312904708979516957590328,    0.01321164115938370158671751695816318467;
 -0.15822625455417853696460187646671225705,   -0.15822625455417853696460187646671225705,    0.55052863586639312904708979516957590328,    0.01321164115938370158671751695816318467;
  0.18199793495199664689817847929133993856,    0.18199793495199664689817847929133993856,   0.094130036292678266102175169411106014378,    0.04248249939111569201880871313257692538;
  0.18199793495199664689817847929133993856,   -0.18199793495199664689817847929133993856,   0.094130036292678266102175169411106014378,    0.04248249939111569201880871313257692538;
 -0.18199793495199664689817847929133993856,    0.18199793495199664689817847929133993856,   0.094130036292678266102175169411106014378,    0.04248249939111569201880871313257692538;
 -0.18199793495199664689817847929133993856,   -0.18199793495199664689817847929133993856,   0.094130036292678266102175169411106014378,    0.04248249939111569201880871313257692538;
  0.84558414980124129459537713613832697939,    0.84558414980124129459537713613832697939,   -0.85420317704867900916510706229135574932,   0.013577406627154434615745463141085805356;
  0.84558414980124129459537713613832697939,   -0.84558414980124129459537713613832697939,   -0.85420317704867900916510706229135574932,   0.013577406627154434615745463141085805356;
 -0.84558414980124129459537713613832697939,    0.84558414980124129459537713613832697939,   -0.85420317704867900916510706229135574932,   0.013577406627154434615745463141085805356;
 -0.84558414980124129459537713613832697939,   -0.84558414980124129459537713613832697939,   -0.85420317704867900916510706229135574932,   0.013577406627154434615745463141085805356;
  0.64686940593734291264486164508395007448,    0.64686940593734291264486164508395007448,    -0.4327553204044903896084514899827863369,   0.018255448920823418809917141458083463367;
  0.64686940593734291264486164508395007448,   -0.64686940593734291264486164508395007448,    -0.4327553204044903896084514899827863369,   0.018255448920823418809917141458083463367;
 -0.64686940593734291264486164508395007448,    0.64686940593734291264486164508395007448,    -0.4327553204044903896084514899827863369,   0.018255448920823418809917141458083463367;
 -0.64686940593734291264486164508395007448,   -0.64686940593734291264486164508395007448,    -0.4327553204044903896084514899827863369,   0.018255448920823418809917141458083463367;
  0.58758702940872080235172874857818290802,    0.58758702940872080235172874857818290802,   -0.88037395641454691452237186705157604445,   0.040101387680976965655189913433625764305;
  0.58758702940872080235172874857818290802,   -0.58758702940872080235172874857818290802,   -0.88037395641454691452237186705157604445,   0.040101387680976965655189913433625764305;
 -0.58758702940872080235172874857818290802,    0.58758702940872080235172874857818290802,   -0.88037395641454691452237186705157604445,   0.040101387680976965655189913433625764305;
 -0.58758702940872080235172874857818290802,   -0.58758702940872080235172874857818290802,   -0.88037395641454691452237186705157604445,   0.040101387680976965655189913433625764305;
  0.22376205998381611725842742973864304392,    0.22376205998381611725842742973864304392,   -0.86833824003875333700960736566405613663,   0.041640434996784578197489213844819716323;
  0.22376205998381611725842742973864304392,   -0.22376205998381611725842742973864304392,   -0.86833824003875333700960736566405613663,   0.041640434996784578197489213844819716323;
 -0.22376205998381611725842742973864304392,    0.22376205998381611725842742973864304392,   -0.86833824003875333700960736566405613663,   0.041640434996784578197489213844819716323;
 -0.22376205998381611725842742973864304392,   -0.22376205998381611725842742973864304392,   -0.86833824003875333700960736566405613663,   0.041640434996784578197489213844819716323;
  0.74556570846972106998428795431576226847,    0.22471743188490617098996468276780795745,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
  0.22471743188490617098996468276780795745,    0.74556570846972106998428795431576226847,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
  0.74556570846972106998428795431576226847,   -0.22471743188490617098996468276780795745,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
 -0.22471743188490617098996468276780795745,    0.74556570846972106998428795431576226847,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
 -0.74556570846972106998428795431576226847,    0.22471743188490617098996468276780795745,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
  0.22471743188490617098996468276780795745,   -0.74556570846972106998428795431576226847,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
 -0.74556570846972106998428795431576226847,   -0.22471743188490617098996468276780795745,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
 -0.22471743188490617098996468276780795745,   -0.74556570846972106998428795431576226847,   -0.94549948945065210679473240922421954622,   0.023758293511727935483135714858684359226;
  0.40566195273187711340899110766544318165,    0.74872676280187880094043851032586166563,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
  0.74872676280187880094043851032586166563,    0.40566195273187711340899110766544318165,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
  0.40566195273187711340899110766544318165,   -0.74872676280187880094043851032586166563,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
 -0.74872676280187880094043851032586166563,    0.40566195273187711340899110766544318165,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
 -0.40566195273187711340899110766544318165,    0.74872676280187880094043851032586166563,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
  0.74872676280187880094043851032586166563,   -0.40566195273187711340899110766544318165,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
 -0.40566195273187711340899110766544318165,   -0.74872676280187880094043851032586166563,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
 -0.74872676280187880094043851032586166563,   -0.40566195273187711340899110766544318165,   -0.67639997414589843421870375009684158879,   0.044777923892939049214710728242065071131;
 0.070742568281209621329314096569945291862,    0.60045691112687358169539106741319911554,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
  0.60045691112687358169539106741319911554,   0.070742568281209621329314096569945291862,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
 0.070742568281209621329314096569945291862,   -0.60045691112687358169539106741319911554,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
 -0.60045691112687358169539106741319911554,   0.070742568281209621329314096569945291862,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
-0.070742568281209621329314096569945291862,    0.60045691112687358169539106741319911554,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
  0.60045691112687358169539106741319911554,  -0.070742568281209621329314096569945291862,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
-0.070742568281209621329314096569945291862,   -0.60045691112687358169539106741319911554,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
 -0.60045691112687358169539106741319911554,  -0.070742568281209621329314096569945291862,   -0.28305887282189848782440087097630180014,    0.02188199761414342991806676205008653974;
  0.94221914707966808645220493887337761891,    0.63756310407853872036884558065034515453,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
  0.63756310407853872036884558065034515453,    0.94221914707966808645220493887337761891,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
  0.94221914707966808645220493887337761891,   -0.63756310407853872036884558065034515453,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
 -0.63756310407853872036884558065034515453,    0.94221914707966808645220493887337761891,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
 -0.94221914707966808645220493887337761891,    0.63756310407853872036884558065034515453,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
  0.63756310407853872036884558065034515453,   -0.94221914707966808645220493887337761891,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
 -0.94221914707966808645220493887337761891,   -0.63756310407853872036884558065034515453,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576;
 -0.63756310407853872036884558065034515453,   -0.94221914707966808645220493887337761891,   -0.98511871784623050002484940519580993686,   0.006724130291414485504002863473684804576];

w=M(:,4);
xi=M(:,1:3)';

end

%LICENSE:
%
%The source code is in the public domain and not licensed or under
%copyright. The information and software may be used freely by the public.
%As required by 17 U.S.C. 403, third parties producing copyrighted works
%consisting predominantly of the material produced by U.S. government
%agencies must provide notice with such work(s) identifying the U.S.
%Government material incorporated and stating that such material is not
%subject to copyright protection.
%
%Derived works shall not identify themselves in a manner that implies an
%endorsement by or an affiliation with the Naval Research Laboratory.
%
%RECIPIENT BEARS ALL RISK RELATING TO QUALITY AND PERFORMANCE OF THE
%SOFTWARE AND ANY RELATED MATERIALS, AND AGREES TO INDEMNIFY THE NAVAL
%RESEARCH LABORATORY FOR ALL THIRD-PARTY CLAIMS RESULTING FROM THE ACTIONS
%OF RECIPIENT IN THE USE OF THE SOFTWARE.
