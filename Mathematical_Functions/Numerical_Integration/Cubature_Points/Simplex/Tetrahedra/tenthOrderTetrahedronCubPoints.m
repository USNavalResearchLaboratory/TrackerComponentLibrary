function [xi,w]=tenthOrderTetrahedronCubPoints()
%%TENTHORDERTETRAHEDRONCUBPOINTS Obtain tenth-order cubature points for
%   integration over a tetrahedron in 3D. The points and weights are for
%   the tetrahedron with vertices (1,0,0), (0,1,0), (0,0,1), and (0,0,0),
%   but can be transformed to any tetrahedron using
%   transformSimplexTetrahedronPts.
%
%INPUTS: None
%
%OUTPUTS: xi This is a 3XnumCubPoints set of points for the standard
%            tetrahedron.
%          w A 1XnumCubPoints set of cubature weights. This sums to the
%            volume of the standard tetrahedron (1/6).
%
%This function implements the points given in [1] (81 points).
%
%EXAMPLE:
%Given the vertices of the simplex, we compare a tenth-order moment
%computed using these cubature points to one computed using
%monomialIntSimplex. The results are the same within typical finite
%precision limits.
% [xi,w]=tenthOrderTetrahedronCubPoints();
% alpha=[5;3;2];
% theMoment=findMomentFromSamp(alpha,xi,w);
% intVal=monomialIntSimplex(alpha);
% RelErr=(theMoment-intVal)/intVal
%
%REFERENCES:
%[1] F. D. Witherden and P. E. Vincent, "On the identification of symmetric
%    quadrature rules for finite element methods," Computer and Mathematics
%    with Applications, vol. 69, no. 10, pp. 1232-1241, May 2015.
%
%October 2022 David F. Crouse, Naval Research Laboratory, Washington D.C.
%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.

M=[                                    -0.5,                                         -0.5,                                         -0.5,    0.063199698074694317846318428237401466134;
   -0.3754998626096227045403833626263450896,     -0.3754998626096227045403833626263450896,    -0.87350041217113188637884991212096473119,    0.035916079989691599737018881339842778615;
   -0.3754998626096227045403833626263450896,    -0.87350041217113188637884991212096473119,     -0.3754998626096227045403833626263450896,    0.035916079989691599737018881339842778615;
  -0.87350041217113188637884991212096473119,     -0.3754998626096227045403833626263450896,     -0.3754998626096227045403833626263450896,    0.035916079989691599737018881339842778615;
   -0.3754998626096227045403833626263450896,     -0.3754998626096227045403833626263450896,     -0.3754998626096227045403833626263450896,    0.035916079989691599737018881339842778615;
  -0.77138069228530769882525760469269910942,    -0.77138069228530769882525760469269910942,     0.31414207685592309647577281407809732827,    0.013158879622391177646076980573564101693;
  -0.77138069228530769882525760469269910942,     0.31414207685592309647577281407809732827,    -0.77138069228530769882525760469269910942,    0.013158879622391177646076980573564101693;
   0.31414207685592309647577281407809732827,    -0.77138069228530769882525760469269910942,    -0.77138069228530769882525760469269910942,    0.013158879622391177646076980573564101693;
  -0.77138069228530769882525760469269910942,    -0.77138069228530769882525760469269910942,    -0.77138069228530769882525760469269910942,    0.013158879622391177646076980573564101693;
  -0.66902794876077789679101975111094717095,    -0.17913852156206901142420431149697662502,    -0.97269500811508408036057162589509957901,    0.015191841626926975498161246507619114195;
  -0.66902794876077789679101975111094717095,    -0.17913852156206901142420431149697662502,    -0.17913852156206901142420431149697662502,    0.015191841626926975498161246507619114195;
  -0.17913852156206901142420431149697662502,    -0.17913852156206901142420431149697662502,    -0.66902794876077789679101975111094717095,    0.015191841626926975498161246507619114195;
  -0.97269500811508408036057162589509957901,    -0.66902794876077789679101975111094717095,    -0.17913852156206901142420431149697662502,    0.015191841626926975498161246507619114195;
  -0.17913852156206901142420431149697662502,    -0.97269500811508408036057162589509957901,    -0.66902794876077789679101975111094717095,    0.015191841626926975498161246507619114195;
  -0.17913852156206901142420431149697662502,    -0.66902794876077789679101975111094717095,    -0.17913852156206901142420431149697662502,    0.015191841626926975498161246507619114195;
  -0.97269500811508408036057162589509957901,    -0.17913852156206901142420431149697662502,    -0.66902794876077789679101975111094717095,    0.015191841626926975498161246507619114195;
  -0.17913852156206901142420431149697662502,    -0.97269500811508408036057162589509957901,    -0.17913852156206901142420431149697662502,    0.015191841626926975498161246507619114195;
  -0.17913852156206901142420431149697662502,    -0.17913852156206901142420431149697662502,    -0.97269500811508408036057162589509957901,    0.015191841626926975498161246507619114195;
  -0.17913852156206901142420431149697662502,    -0.66902794876077789679101975111094717095,    -0.97269500811508408036057162589509957901,    0.015191841626926975498161246507619114195;
  -0.97269500811508408036057162589509957901,    -0.17913852156206901142420431149697662502,    -0.17913852156206901142420431149697662502,    0.015191841626926975498161246507619114195;
  -0.66902794876077789679101975111094717095,    -0.97269500811508408036057162589509957901,    -0.17913852156206901142420431149697662502,    0.015191841626926975498161246507619114195;
    0.8859775346904097323952611738365015259,    -0.98772398235041850430481257350316929785,     -0.9105295699895727237856360268301629302,  0.00048259245911900483231983784641134908616;
    0.8859775346904097323952611738365015259,    -0.98772398235041850430481257350316929785,    -0.98772398235041850430481257350316929785,  0.00048259245911900483231983784641134908616;
  -0.98772398235041850430481257350316929785,    -0.98772398235041850430481257350316929785,      0.8859775346904097323952611738365015259,  0.00048259245911900483231983784641134908616;
   -0.9105295699895727237856360268301629302,      0.8859775346904097323952611738365015259,    -0.98772398235041850430481257350316929785,  0.00048259245911900483231983784641134908616;
  -0.98772398235041850430481257350316929785,     -0.9105295699895727237856360268301629302,      0.8859775346904097323952611738365015259,  0.00048259245911900483231983784641134908616;
  -0.98772398235041850430481257350316929785,      0.8859775346904097323952611738365015259,    -0.98772398235041850430481257350316929785,  0.00048259245911900483231983784641134908616;
   -0.9105295699895727237856360268301629302,    -0.98772398235041850430481257350316929785,      0.8859775346904097323952611738365015259,  0.00048259245911900483231983784641134908616;
  -0.98772398235041850430481257350316929785,     -0.9105295699895727237856360268301629302,    -0.98772398235041850430481257350316929785,  0.00048259245911900483231983784641134908616;
  -0.98772398235041850430481257350316929785,    -0.98772398235041850430481257350316929785,     -0.9105295699895727237856360268301629302,  0.00048259245911900483231983784641134908616;
  -0.98772398235041850430481257350316929785,      0.8859775346904097323952611738365015259,     -0.9105295699895727237856360268301629302,  0.00048259245911900483231983784641134908616;
   -0.9105295699895727237856360268301629302,    -0.98772398235041850430481257350316929785,    -0.98772398235041850430481257350316929785,  0.00048259245911900483231983784641134908616;
    0.8859775346904097323952611738365015259,     -0.9105295699895727237856360268301629302,    -0.98772398235041850430481257350316929785,  0.00048259245911900483231983784641134908616;
 -0.045619240191439298911787183406185558751,    -0.75789963770882114801220999680989894474,    -0.43858148439091840506379282297401655176,    0.034319642640608095038714683012872940214;
 -0.045619240191439298911787183406185558751,    -0.75789963770882114801220999680989894474,    -0.75789963770882114801220999680989894474,    0.034319642640608095038714683012872940214;
  -0.75789963770882114801220999680989894474,    -0.75789963770882114801220999680989894474,   -0.045619240191439298911787183406185558751,    0.034319642640608095038714683012872940214;
  -0.43858148439091840506379282297401655176,   -0.045619240191439298911787183406185558751,    -0.75789963770882114801220999680989894474,    0.034319642640608095038714683012872940214;
  -0.75789963770882114801220999680989894474,    -0.43858148439091840506379282297401655176,   -0.045619240191439298911787183406185558751,    0.034319642640608095038714683012872940214;
  -0.75789963770882114801220999680989894474,   -0.045619240191439298911787183406185558751,    -0.75789963770882114801220999680989894474,    0.034319642640608095038714683012872940214;
  -0.43858148439091840506379282297401655176,    -0.75789963770882114801220999680989894474,   -0.045619240191439298911787183406185558751,    0.034319642640608095038714683012872940214;
  -0.75789963770882114801220999680989894474,    -0.43858148439091840506379282297401655176,    -0.75789963770882114801220999680989894474,    0.034319642640608095038714683012872940214;
  -0.75789963770882114801220999680989894474,    -0.75789963770882114801220999680989894474,    -0.43858148439091840506379282297401655176,    0.034319642640608095038714683012872940214;
  -0.75789963770882114801220999680989894474,   -0.045619240191439298911787183406185558751,    -0.43858148439091840506379282297401655176,    0.034319642640608095038714683012872940214;
  -0.43858148439091840506379282297401655176,    -0.75789963770882114801220999680989894474,    -0.75789963770882114801220999680989894474,    0.034319642640608095038714683012872940214;
 -0.045619240191439298911787183406185558751,    -0.43858148439091840506379282297401655176,    -0.75789963770882114801220999680989894474,    0.034319642640608095038714683012872940214;
   0.18851253896001405132314006877136059652,    -0.93444106356711465845055795933535161918,    -0.31963041182578473442202415010065735815,    0.013514495573007723718021960153355702928;
   0.18851253896001405132314006877136059652,    -0.93444106356711465845055795933535161918,    -0.93444106356711465845055795933535161918,    0.013514495573007723718021960153355702928;
  -0.93444106356711465845055795933535161918,    -0.93444106356711465845055795933535161918,     0.18851253896001405132314006877136059652,    0.013514495573007723718021960153355702928;
  -0.31963041182578473442202415010065735815,     0.18851253896001405132314006877136059652,    -0.93444106356711465845055795933535161918,    0.013514495573007723718021960153355702928;
  -0.93444106356711465845055795933535161918,    -0.31963041182578473442202415010065735815,     0.18851253896001405132314006877136059652,    0.013514495573007723718021960153355702928;
  -0.93444106356711465845055795933535161918,     0.18851253896001405132314006877136059652,    -0.93444106356711465845055795933535161918,    0.013514495573007723718021960153355702928;
  -0.31963041182578473442202415010065735815,    -0.93444106356711465845055795933535161918,     0.18851253896001405132314006877136059652,    0.013514495573007723718021960153355702928;
  -0.93444106356711465845055795933535161918,    -0.31963041182578473442202415010065735815,    -0.93444106356711465845055795933535161918,    0.013514495573007723718021960153355702928;
  -0.93444106356711465845055795933535161918,    -0.93444106356711465845055795933535161918,    -0.31963041182578473442202415010065735815,    0.013514495573007723718021960153355702928;
  -0.93444106356711465845055795933535161918,     0.18851253896001405132314006877136059652,    -0.31963041182578473442202415010065735815,    0.013514495573007723718021960153355702928;
  -0.31963041182578473442202415010065735815,    -0.93444106356711465845055795933535161918,    -0.93444106356711465845055795933535161918,    0.013514495573007723718021960153355702928;
   0.18851253896001405132314006877136059652,    -0.31963041182578473442202415010065735815,    -0.93444106356711465845055795933535161918,    0.013514495573007723718021960153355702928;
   0.60235456931668878246228336815716196359,    -0.93502943687035390432897012004314760659,    -0.73229569557598097380434312807086675041,   0.0087681963693812055566076536006009347954;
   0.60235456931668878246228336815716196359,    -0.93502943687035390432897012004314760659,    -0.93502943687035390432897012004314760659,   0.0087681963693812055566076536006009347954;
  -0.93502943687035390432897012004314760659,    -0.93502943687035390432897012004314760659,     0.60235456931668878246228336815716196359,   0.0087681963693812055566076536006009347954;
  -0.73229569557598097380434312807086675041,     0.60235456931668878246228336815716196359,    -0.93502943687035390432897012004314760659,   0.0087681963693812055566076536006009347954;
  -0.93502943687035390432897012004314760659,    -0.73229569557598097380434312807086675041,     0.60235456931668878246228336815716196359,   0.0087681963693812055566076536006009347954;
  -0.93502943687035390432897012004314760659,     0.60235456931668878246228336815716196359,    -0.93502943687035390432897012004314760659,   0.0087681963693812055566076536006009347954;
  -0.73229569557598097380434312807086675041,    -0.93502943687035390432897012004314760659,     0.60235456931668878246228336815716196359,   0.0087681963693812055566076536006009347954;
  -0.93502943687035390432897012004314760659,    -0.73229569557598097380434312807086675041,    -0.93502943687035390432897012004314760659,   0.0087681963693812055566076536006009347954;
  -0.93502943687035390432897012004314760659,    -0.93502943687035390432897012004314760659,    -0.73229569557598097380434312807086675041,   0.0087681963693812055566076536006009347954;
  -0.93502943687035390432897012004314760659,     0.60235456931668878246228336815716196359,    -0.73229569557598097380434312807086675041,   0.0087681963693812055566076536006009347954;
  -0.73229569557598097380434312807086675041,    -0.93502943687035390432897012004314760659,    -0.93502943687035390432897012004314760659,   0.0087681963693812055566076536006009347954;
   0.60235456931668878246228336815716196359,    -0.73229569557598097380434312807086675041,    -0.93502943687035390432897012004314760659,   0.0087681963693812055566076536006009347954;
    0.2561436909507320213865521444358193313,    -0.65004131563212195143010154694337920556,    -0.95606105968648811852634905054906092018,    0.017209381065149320852393906999331987612;
    0.2561436909507320213865521444358193313,    -0.65004131563212195143010154694337920556,    -0.65004131563212195143010154694337920556,    0.017209381065149320852393906999331987612;
  -0.65004131563212195143010154694337920556,    -0.65004131563212195143010154694337920556,      0.2561436909507320213865521444358193313,    0.017209381065149320852393906999331987612;
  -0.95606105968648811852634905054906092018,      0.2561436909507320213865521444358193313,    -0.65004131563212195143010154694337920556,    0.017209381065149320852393906999331987612;
  -0.65004131563212195143010154694337920556,    -0.95606105968648811852634905054906092018,      0.2561436909507320213865521444358193313,    0.017209381065149320852393906999331987612;
  -0.65004131563212195143010154694337920556,      0.2561436909507320213865521444358193313,    -0.65004131563212195143010154694337920556,    0.017209381065149320852393906999331987612;
  -0.95606105968648811852634905054906092018,    -0.65004131563212195143010154694337920556,      0.2561436909507320213865521444358193313,    0.017209381065149320852393906999331987612;
  -0.65004131563212195143010154694337920556,    -0.95606105968648811852634905054906092018,    -0.65004131563212195143010154694337920556,    0.017209381065149320852393906999331987612;
  -0.65004131563212195143010154694337920556,    -0.65004131563212195143010154694337920556,    -0.95606105968648811852634905054906092018,    0.017209381065149320852393906999331987612;
  -0.65004131563212195143010154694337920556,      0.2561436909507320213865521444358193313,    -0.95606105968648811852634905054906092018,    0.017209381065149320852393906999331987612;
  -0.95606105968648811852634905054906092018,    -0.65004131563212195143010154694337920556,    -0.65004131563212195143010154694337920556,    0.017209381065149320852393906999331987612;
    0.2561436909507320213865521444358193313,    -0.95606105968648811852634905054906092018,    -0.65004131563212195143010154694337920556,    0.017209381065149320852393906999331987612];

w=M(:,4);
xi=M(:,1:3)';
%Transform the points to the standard tetrahedron.
v1=[-1, 1,-1,-1;
    -1,-1,-1, 1;
    -1,-1, 1, -1];
v2=[1,0,0,0;
    0,1,0,0;
    0,0,1,0];
[A,d]=affineTransBetweenTetrahedra(v1,v2);
xi=bsxfun(@plus,A*xi,d);
w=w/8;
end

%LICENSE:
%
%The source code is in the public domain and not licensed or under
%copyright. The information and software may be used freely by the public.
%As required by 17 U.S.C. 403, third parties producing copyrighted works
%consisting predominantly of the material produced by U.S. government
%agencies must provide notice with such work(s) identifying the U.S.
%Government material incorporated and stating that such material is not
%subject to copyright protection.
%
%Derived works shall not identify themselves in a manner that implies an
%endorsement by or an affiliation with the Naval Research Laboratory.
%
%RECIPIENT BEARS ALL RISK RELATING TO QUALITY AND PERFORMANCE OF THE
%SOFTWARE AND ANY RELATED MATERIALS, AND AGREES TO INDEMNIFY THE NAVAL
%RESEARCH LABORATORY FOR ALL THIRD-PARTY CLAIMS RESULTING FROM THE ACTIONS
%OF RECIPIENT IN THE USE OF THE SOFTWARE.
