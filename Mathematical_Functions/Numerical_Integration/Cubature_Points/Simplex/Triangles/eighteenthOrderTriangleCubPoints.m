function [xi,w]=eighteenthOrderTriangleCubPoints()
%%EIGHTEENTHORDERTRIANGLECUBPOINTS Obtain eighteenth-order cubature
%   points for integration over a triangle in 2D. The points and weights
%   are for the triangle with vertices (1,0), (0,1), (0,0), but can be
%   transformed to any triangle using transformSimplexTriPoints.
%
%INPUTS: None
%
%OUTPUTS: xi A 2XnumCubPoints set of points for the standard triangle.
%          w A 1XnumCubPoints set of cubature weights. This sums to the
%            volume of the triangle (1/2).
%
%This function implements the points given in [1] (67 points).
%
%EXAMPLE:
%Given the vertices of the simplex, we compare a eighteenth-order moment
%computed using these cubature points to one computed using
%monomialIntSimplex. The results are the same within typical finite
%precision limits.
% [xi,w]=eighteenthOrderTriangleCubPoints();
% alpha=[9;9];
% theMoment=findMomentFromSamp(alpha,xi,w)
% intVal=monomialIntSimplex(alpha)
%
%REFERENCES:
%[1] F. D. Witherden and P. E. Vincent, "On the identification of symmetric
%    quadrature rules for finite element methods," Computer and Mathematics
%    with Applications, vol. 69, no. 10, pp. 1232-1241, May 2015.
%
%October 2022 David F. Crouse, Naval Research Laboratory, Washington D.C.
%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.

M=[ -0.33333333333333333333333333333333333333,   -0.33333333333333333333333333333333333333,   0.072711470602853332335988402976151320416;
 -0.20008874386484753663926775646038722347,   -0.59982251227030492672146448707922555305,   0.066608940066780270570831020513249877437;
 -0.59982251227030492672146448707922555305,   -0.20008874386484753663926775646038722347,   0.066608940066780270570831020513249877437;
 -0.20008874386484753663926775646038722347,   -0.20008874386484753663926775646038722347,   0.066608940066780270570831020513249877437;
-0.024839396850260875373628934599793544657,   -0.95032120629947824925274213080041291069,   0.024093295267999420236853581306803869378;
 -0.95032120629947824925274213080041291069,  -0.024839396850260875373628934599793544657,   0.024093295267999420236853581306803869378;
-0.024839396850260875373628934599793544657,  -0.024839396850260875373628934599793544657,   0.024093295267999420236853581306803869378;
-0.076380987187101537262574124416325864243,   -0.84723802562579692547485175116734827151,   0.037898343013557732052184724503582760819;
 -0.84723802562579692547485175116734827151,  -0.076380987187101537262574124416325864243,   0.037898343013557732052184724503582760819;
-0.076380987187101537262574124416325864243,  -0.076380987187101537262574124416325864243,   0.037898343013557732052184724503582760819;
 -0.51547059497145607559012153340572104878,   0.030941189942912151180243066811442097565,   0.072950178817887274068289295917294690431;
 0.030941189942912151180243066811442097565,   -0.51547059497145607559012153340572104878,   0.072950178817887274068289295917294690431;
 -0.51547059497145607559012153340572104878,   -0.51547059497145607559012153340572104878,   0.072950178817887274068289295917294690431;
 -0.92233948782262881057955835940173820882,    0.84467897564525762115911671880347641764,   0.014258652039437941355528309610938991063;
  0.84467897564525762115911671880347641764,   -0.92233948782262881057955835940173820882,   0.014258652039437941355528309610938991063;
 -0.92233948782262881057955835940173820882,   -0.92233948782262881057955835940173820882,   0.014258652039437941355528309610938991063;
 -0.81610451575671360652823121099663693088,    0.63220903151342721305646242199327386177,   0.033118319904006498336116111979261819383;
  0.63220903151342721305646242199327386177,   -0.81610451575671360652823121099663693088,   0.033118319904006498336116111979261819383;
 -0.81610451575671360652823121099663693088,   -0.81610451575671360652823121099663693088,   0.033118319904006498336116111979261819383;
 -0.90839016828027843774281581498808452091,    0.54074475242935042645861991501168424548,    0.02751923246988441047583904641836977339;
  0.54074475242935042645861991501168424548,   -0.90839016828027843774281581498808452091,    0.02751923246988441047583904641836977339;
 -0.63235458414907198871580410002359972457,    0.54074475242935042645861991501168424548,    0.02751923246988441047583904641836977339;
  0.54074475242935042645861991501168424548,   -0.63235458414907198871580410002359972457,    0.02751923246988441047583904641836977339;
 -0.63235458414907198871580410002359972457,   -0.90839016828027843774281581498808452091,    0.02751923246988441047583904641836977339;
 -0.90839016828027843774281581498808452091,   -0.63235458414907198871580410002359972457,    0.02751923246988441047583904641836977339;
 -0.58730148513232413316130962964884514978,     0.3419079703884690263223113955340021876,   0.047563821800305659903183394223175954568;
   0.3419079703884690263223113955340021876,   -0.58730148513232413316130962964884514978,   0.047563821800305659903183394223175954568;
 -0.75460648525614489316100176588515703782,     0.3419079703884690263223113955340021876,   0.047563821800305659903183394223175954568;
   0.3419079703884690263223113955340021876,   -0.75460648525614489316100176588515703782,   0.047563821800305659903183394223175954568;
 -0.75460648525614489316100176588515703782,   -0.58730148513232413316130962964884514978,   0.047563821800305659903183394223175954568;
 -0.58730148513232413316130962964884514978,   -0.75460648525614489316100176588515703782,   0.047563821800305659903183394223175954568;
 -0.99220477793305323492615661731437867596,    0.20083790926851382953172593624080189463,  0.0090610690045141307984091089591295584041;
  0.20083790926851382953172593624080189463,   -0.99220477793305323492615661731437867596,  0.0090610690045141307984091089591295584041;
 -0.20863313133546059460556931892642321867,    0.20083790926851382953172593624080189463,  0.0090610690045141307984091089591295584041;
  0.20083790926851382953172593624080189463,   -0.20863313133546059460556931892642321867,  0.0090610690045141307984091089591295584041;
 -0.20863313133546059460556931892642321867,   -0.99220477793305323492615661731437867596,  0.0090610690045141307984091089591295584041;
 -0.99220477793305323492615661731437867596,   -0.20863313133546059460556931892642321867,  0.0090610690045141307984091089591295584041;
 -0.97307596651711002157127978980742349944,     0.7566843789350434355117007033556566479,   0.013680220239214362980455516076649575226;
   0.7566843789350434355117007033556566479,   -0.97307596651711002157127978980742349944,   0.013680220239214362980455516076649575226;
 -0.78360841241793341394042091354823314847,     0.7566843789350434355117007033556566479,   0.013680220239214362980455516076649575226;
   0.7566843789350434355117007033556566479,   -0.78360841241793341394042091354823314847,   0.013680220239214362980455516076649575226;
 -0.78360841241793341394042091354823314847,   -0.97307596651711002157127978980742349944,   0.013680220239214362980455516076649575226;
 -0.97307596651711002157127978980742349944,   -0.78360841241793341394042091354823314847,   0.013680220239214362980455516076649575226;
 -0.91947943306018387371123279519490851215,    0.27997618400942918982209258667637955233,   0.035494978204040810232789924461690967346;
  0.27997618400942918982209258667637955233,   -0.91947943306018387371123279519490851215,   0.035494978204040810232789924461690967346;
 -0.36049675094924531611085979148147104018,    0.27997618400942918982209258667637955233,   0.035494978204040810232789924461690967346;
  0.27997618400942918982209258667637955233,   -0.36049675094924531611085979148147104018,   0.035494978204040810232789924461690967346;
 -0.36049675094924531611085979148147104018,   -0.91947943306018387371123279519490851215,   0.035494978204040810232789924461690967346;
 -0.91947943306018387371123279519490851215,   -0.36049675094924531611085979148147104018,   0.035494978204040810232789924461690967346;
 -0.98940332962678046939842579820752941279,    0.51785895971039698809029890766872251942,   0.010021321749159443407741271393882052956;
  0.51785895971039698809029890766872251942,   -0.98940332962678046939842579820752941279,   0.010021321749159443407741271393882052956;
 -0.52845563008361651869187310946119310664,    0.51785895971039698809029890766872251942,   0.010021321749159443407741271393882052956;
  0.51785895971039698809029890766872251942,   -0.52845563008361651869187310946119310664,   0.010021321749159443407741271393882052956;
 -0.52845563008361651869187310946119310664,   -0.98940332962678046939842579820752941279,   0.010021321749159443407741271393882052956;
 -0.98940332962678046939842579820752941279,   -0.52845563008361651869187310946119310664,   0.010021321749159443407741271393882052956;
 -0.99890327991591536201516398045062601334,    0.94472145792559133356359726011634553554,  0.0024458962539221795584360481949957423674;
  0.94472145792559133356359726011634553554,   -0.99890327991591536201516398045062601334,  0.0024458962539221795584360481949957423674;
  -0.9458181780096759715484332796657195222,    0.94472145792559133356359726011634553554,  0.0024458962539221795584360481949957423674;
  0.94472145792559133356359726011634553554,    -0.9458181780096759715484332796657195222,  0.0024458962539221795584360481949957423674;
  -0.9458181780096759715484332796657195222,   -0.99890327991591536201516398045062601334,  0.0024458962539221795584360481949957423674;
 -0.99890327991591536201516398045062601334,    -0.9458181780096759715484332796657195222,  0.0024458962539221795584360481949957423674;
 -0.75882460967215071364642989357871249414,   0.091837550772389199617388042151854332785,   0.050964350623648878943912767860515151418;
 0.091837550772389199617388042151854332785,   -0.75882460967215071364642989357871249414,   0.050964350623648878943912767860515151418;
 -0.33301294110023848597095814857314183865,   0.091837550772389199617388042151854332785,   0.050964350623648878943912767860515151418;
 0.091837550772389199617388042151854332785,   -0.33301294110023848597095814857314183865,   0.050964350623648878943912767860515151418;
 -0.33301294110023848597095814857314183865,   -0.75882460967215071364642989357871249414,   0.050964350623648878943912767860515151418;
 -0.75882460967215071364642989357871249414,   -0.33301294110023848597095814857314183865,   0.050964350623648878943912767860515151418];

 w=M(:,3);
xi=M(:,1:2)';
%Transform the points to the standard triangle.
v1=[-1,-1, 1;
    -1, 1,-1];
v2=[1,0,0;
    0,1,0];
[A,d]=affineTransBetweenTriangles(v1,v2);
xi=bsxfun(@plus,A*xi,d);
w=w/4;
end

%LICENSE:
%
%The source code is in the public domain and not licensed or under
%copyright. The information and software may be used freely by the public.
%As required by 17 U.S.C. 403, third parties producing copyrighted works
%consisting predominantly of the material produced by U.S. government
%agencies must provide notice with such work(s) identifying the U.S.
%Government material incorporated and stating that such material is not
%subject to copyright protection.
%
%Derived works shall not identify themselves in a manner that implies an
%endorsement by or an affiliation with the Naval Research Laboratory.
%
%RECIPIENT BEARS ALL RISK RELATING TO QUALITY AND PERFORMANCE OF THE
%SOFTWARE AND ANY RELATED MATERIALS, AND AGREES TO INDEMNIFY THE NAVAL
%RESEARCH LABORATORY FOR ALL THIRD-PARTY CLAIMS RESULTING FROM THE ACTIONS
%OF RECIPIENT IN THE USE OF THE SOFTWARE.
