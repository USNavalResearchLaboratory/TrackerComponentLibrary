function [xi,w]=twentiethOrderTriangleCubPoints(algorithm)
%%TWENTIETHORDERTRIANGLECUBPOINTS Obtain twentieth-order cubature points
%   for integration over a triangle in 2D. The points and weights are for
%   the triangle with vertices (1,0), (0,1), (0,0), but can be transformed
%   to any triangle using transformSimplexTriPoints.
%
%INPUTS: algorithm An optional parameter selecting the algorithm for the
%                  specific point set. Possible values are:
%                  0 Use the algorithm of [1] (288 points).
%                  1 (The default if omitted or an empty matrix is passed)
%                    Use the 20th order points found using the algorithm of
%                    [2], given in the supplementary material of [2] (79
%                    points).
%
%OUTPUTS: xi A 2XnumCubPoints set of points for the standard triangle.
%          w A 1XnumCubPoints set of cubature weights. This sums to the
%            volume of the triangle (1/2).
%
%This function implements the points given in [1] and [2].
%
%EXAMPLE:
%Given the vertices of the simplex, we compare a twentieth-order moment
%computed using these cubature points to one computed using
%monomialIntSimplex. The results are the same within typical finite
% [xi,w]=twentiethOrderTriangleCubPoints();
% alpha=[9;11];
% theMoment=findMomentFromSamp(alpha,xi,w)
% intVal=monomialIntSimplex(alpha)
%
%REFERENCES:
%[1]L. Zhang and T. Cui, "A set of symmetric quadrature rules on triangles
%   and tetrahedra," Journal of Computational Mathematics, vol. 27, no. 1,
%   pp. 89-96, Jan. 2009.
%[2] F. D. Witherden and P. E. Vincent, "On the identification of symmetric
%    quadrature rules for finite element methods," Computer and Mathematics
%    with Applications, vol. 69, no. 10, pp. 1232-1241, May 2015.
%
%October 2022 David F. Crouse, Naval Research Laboratory, Washington D.C.
%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.

if(nargin<1||isempty(algorithm))
    algorithm=1;
end

switch(algorithm)
    case 0
        w1=0.0125376079944966565735856367723948;
        w2=0.0274718698764242137484535496073598;
        w3=0.0097652722770514230413646914294237;
        w4=0.0013984195353918235239233631597867;
        w5=0.0092921026251851826304282034030330;
        w6=0.0165778760323669253260236250351840;
        w7=0.0206677623486650769614219700129729;
        w8=0.0208222355211545073068785561993297;
        w9=0.0095686384198490606888758450458320;
        w10=0.0244527709689724638856439207024089;
        w11=0.0031557306306305340038264003207296;
        w12=0.0121367963653212969370133090807574;
        w13=0.0149664801438864490365249118515707;
        w14=0.0063275933217777395693240327504398;
        w15=0.0013425603120636958849798512981433;
        w16=0.0027760769163475540677293561558015;
        w17=0.0107398444741849415551734474479517;
        w18=0.0053678057381874532052474100212697;
        
        w=[w1;
           w2*ones(3,1);
           w3*ones(3,1);
           w4*ones(3,1);
           w5*ones(3,1);
           w6*ones(3,1);
           w7*ones(6,1);
           w8*ones(6,1);
           w9*ones(6,1);
           w10*ones(6,1);
           w11*ones(6,1);
           w12*ones(6,1);
           w13*ones(6,1);
           w14*ones(6,1);
           w15*ones(6,1);
           w16*ones(6,1);
           w17*ones(6,1);
           w18*ones(6,1)];
        
        p1=0.3333333333333333333333333333333333;
        p2=0.2158743059329919731902545438401828; 
        p3=0.0753767665297472780972854309459163;
        p4=0.0103008281372217921136862160096969;
        p5=0.4936022112987001655119208321450536;
        p6=0.4615509381069252967410487102915180;
        p7a=0.3286214064242369933034974609509133;
        p7b=0.4293405702582103752139588004663984;
        p8a=0.2604803617865687564195930170811535;
        p8b=0.1015775342809694461687550061961797;
        p9a=0.1370742358464553000000000000000000;
        p9b=0.7100659730011301599879040745464079;
        p10a=0.1467269458722997843041609884874530;
        p10b=0.4985454776784148493896226967076119;
        p11a=0.0269989777425532900000000000000000;
        p11b=0.0491867226725820016197037125775872;
        p12a=0.0618717859336170268417124700122339;
        p12b=0.7796601465405693953603506190768108;
        p13a=0.0477243674276219962083526801042934;
        p13b=0.3704915391495476369201496202567388;
        p14a=0.1206005151863643799672337870400794;
        p14b=0.8633469487547526484979879960925217;
        p15a=0.0026971477967097876716489145012827;
        p15b=0.0561949381877455029878923019865887;
        p16a=0.0030156332779423626572762598234710;
        p16b=0.2086750067484213509575944630613577;
        p17a=0.0299053757884570188069287738643386;
        p17b=0.7211512409120340910281041502050941;
        p18a=0.0067566542224609885399458175192278;
        p18b=0.6400554419405418899040536682721647;
        
        xiBary=zeros(3,88);
        xiBary(:,1)=p1;
        xiBary(:,2:4)=genAllMultisetPermutations([p2;p2;1-2*p2]);
        xiBary(:,5:7)=genAllMultisetPermutations([p3;p3;1-2*p3]);
        xiBary(:,8:10)=genAllMultisetPermutations([p4;p4;1-2*p4]);
        xiBary(:,11:13)=genAllMultisetPermutations([p5;p5;1-2*p5]);
        xiBary(:,14:16)=genAllMultisetPermutations([p6;p6;1-2*p6]);
        
        xiBary(:,17:22)=genAllMultisetPermutations([p7a;p7b;1-p7a-p7b]);
        xiBary(:,23:28)=genAllMultisetPermutations([p8a;p8b;1-p8a-p8b]);
        xiBary(:,29:34)=genAllMultisetPermutations([p9a;p9b;1-p9a-p9b]);
        xiBary(:,35:40)=genAllMultisetPermutations([p10a;p10b;1-p10a-p10b]);
        xiBary(:,41:46)=genAllMultisetPermutations([p11a;p11b;1-p11a-p11b]);
        xiBary(:,47:52)=genAllMultisetPermutations([p12a;p12b;1-p12a-p12b]);
        xiBary(:,53:58)=genAllMultisetPermutations([p13a;p13b;1-p13a-p13b]);
        xiBary(:,59:64)=genAllMultisetPermutations([p14a;p14b;1-p14a-p14b]);
        xiBary(:,65:70)=genAllMultisetPermutations([p15a;p15b;1-p15a-p15b]);
        xiBary(:,71:76)=genAllMultisetPermutations([p16a;p16b;1-p16a-p16b]);
        xiBary(:,77:82)=genAllMultisetPermutations([p17a;p17b;1-p17a-p17b]);
        xiBary(:,83:88)=genAllMultisetPermutations([p18a;p18b;1-p18a-p18b]);
        
        %Adjust w for the triangle area.
        w=w/2;
        
        %Convert the barycentric points into normal cubature points for the
        %specific triangle given the vertices.
        vertices=[1,0,0;
                  0,1,0];
        xi=barycentricCoords2Pt(xiBary,vertices);
    case 1
M=[-0.33333333333333333333333333333333333333,   -0.33333333333333333333333333333333333333,   0.055640442805812463631566788253898051532;
   -0.49084146465332177523029470374523072315,  -0.018317070693356449539410592509538553699,    0.05633280523008099012864178412473069936;
  -0.018317070693356449539410592509538553699,   -0.49084146465332177523029470374523072315,    0.05633280523008099012864178412473069936;
   -0.49084146465332177523029470374523072315,   -0.49084146465332177523029470374523072315,    0.05633280523008099012864178412473069936;
   -0.97804771794320447192070397628224037507,    0.95609543588640894384140795256448075015,  0.0031953631642664794478945847330657770722;
    0.95609543588640894384140795256448075015,   -0.97804771794320447192070397628224037507,  0.0031953631642664794478945847330657770722;
   -0.97804771794320447192070397628224037507,   -0.97804771794320447192070397628224037507,  0.0031953631642664794478945847330657770722;
   -0.78123280657657080596625505020033275589,    0.56246561315314161193251010040066551178,   0.031320923104298133684407003648894203447;
    0.56246561315314161193251010040066551178,   -0.78123280657657080596625505020033275589,   0.031320923104298133684407003648894203447;
   -0.78123280657657080596625505020033275589,   -0.78123280657657080596625505020033275589,   0.031320923104298133684407003648894203447;
   -0.62741000451091811445653498388475129105,     0.2548200090218362289130699677695025821,   0.036693851897011657919252854118138043537;
     0.2548200090218362289130699677695025821,   -0.62741000451091811445653498388475129105,   0.036693851897011657919252854118138043537;
   -0.62741000451091811445653498388475129105,   -0.62741000451091811445653498388475129105,   0.036693851897011657919252854118138043537;
   -0.10889788608815036962555544313157118467,   -0.78220422782369926074888911373685763067,   0.037809599732929790747314162640799596721;
   -0.78220422782369926074888911373685763067,   -0.10889788608815036962555544313157118467,   0.037809599732929790747314162640799596721;
   -0.10889788608815036962555544313157118467,   -0.10889788608815036962555544313157118467,   0.037809599732929790747314162640799596721;
   -0.92537823880223061201299256742556755612,    0.85075647760446122402598513485113511224,   0.008645101642662310104692722157806774508;
    0.85075647760446122402598513485113511224,   -0.92537823880223061201299256742556755612,   0.008645101642662310104692722157806774508;
   -0.92537823880223061201299256742556755612,   -0.92537823880223061201299256742556755612,   0.008645101642662310104692722157806774508;
   -0.21314930436580028264207251299344481704,   -0.57370139126839943471585497401311036593,   0.055152202516281836053550890863277393079;
   -0.57370139126839943471585497401311036593,   -0.21314930436580028264207251299344481704,   0.055152202516281836053550890863277393079;
   -0.21314930436580028264207251299344481704,   -0.21314930436580028264207251299344481704,   0.055152202516281836053550890863277393079;
  -0.047508776919001973579296255534818088061,   -0.90498244616199605284140748893036382388,   0.028407301213633761967680465924479290382;
   -0.90498244616199605284140748893036382388,  -0.047508776919001973579296255534818088061,   0.028407301213633761967680465924479290382;
  -0.047508776919001973579296255534818088061,  -0.047508776919001973579296255534818088061,   0.028407301213633761967680465924479290382;
   -0.98485843899060694347353308294287690802,    0.66659102367647249434430238008617319241,  0.0088115896742339902561312708157853846482;
    0.66659102367647249434430238008617319241,   -0.98485843899060694347353308294287690802,  0.0088115896742339902561312708157853846482;
   -0.68173258468586555087076929714329628438,    0.66659102367647249434430238008617319241,  0.0088115896742339902561312708157853846482;
    0.66659102367647249434430238008617319241,   -0.68173258468586555087076929714329628438,  0.0088115896742339902561312708157853846482;
   -0.68173258468586555087076929714329628438,   -0.98485843899060694347353308294287690802,  0.0088115896742339902561312708157853846482;
   -0.98485843899060694347353308294287690802,   -0.68173258468586555087076929714329628438,  0.0088115896742339902561312708157853846482;
   -0.90687927018467136697246089078946388707,     0.5098430057270950102124174847737658903,   0.023945594315818760080585256144999165493;
     0.5098430057270950102124174847737658903,   -0.90687927018467136697246089078946388707,   0.023945594315818760080585256144999165493;
   -0.60296373554242364323995659398430200323,     0.5098430057270950102124174847737658903,   0.023945594315818760080585256144999165493;
     0.5098430057270950102124174847737658903,   -0.60296373554242364323995659398430200323,   0.023945594315818760080585256144999165493;
   -0.60296373554242364323995659398430200323,   -0.90687927018467136697246089078946388707,   0.023945594315818760080585256144999165493;
   -0.90687927018467136697246089078946388707,   -0.60296373554242364323995659398430200323,   0.023945594315818760080585256144999165493;
   -0.87181882878313187990026866476433962457,    0.86210895356788437332353836160651207109,  0.0045194784085034621179235150583929560485;
    0.86210895356788437332353836160651207109,   -0.87181882878313187990026866476433962457,  0.0045194784085034621179235150583929560485;
   -0.99029012478475249342326969684217244652,    0.86210895356788437332353836160651207109,  0.0045194784085034621179235150583929560485;
    0.86210895356788437332353836160651207109,   -0.99029012478475249342326969684217244652,  0.0045194784085034621179235150583929560485;
   -0.99029012478475249342326969684217244652,   -0.87181882878313187990026866476433962457,  0.0045194784085034621179235150583929560485;
   -0.87181882878313187990026866476433962457,   -0.99029012478475249342326969684217244652,  0.0045194784085034621179235150583929560485;
   -0.89002504171402637873154550296837045792,    0.22375540709485139987629530764328543032,   0.034668902268877332248730626058035734221;
    0.22375540709485139987629530764328543032,   -0.89002504171402637873154550296837045792,   0.034668902268877332248730626058035734221;
    -0.3337303653808250211447498046749149724,    0.22375540709485139987629530764328543032,   0.034668902268877332248730626058035734221;
    0.22375540709485139987629530764328543032,    -0.3337303653808250211447498046749149724,   0.034668902268877332248730626058035734221;
    -0.3337303653808250211447498046749149724,   -0.89002504171402637873154550296837045792,   0.034668902268877332248730626058035734221;
   -0.89002504171402637873154550296837045792,    -0.3337303653808250211447498046749149724,   0.034668902268877332248730626058035734221;
    -0.8000954074237226892341843533057676038,    0.72336803787297349848896164841146460112,   0.016582846110455430851049450635630476598;
    0.72336803787297349848896164841146460112,    -0.8000954074237226892341843533057676038,   0.016582846110455430851049450635630476598;
   -0.92327263044925080925477729510569699731,    0.72336803787297349848896164841146460112,   0.016582846110455430851049450635630476598;
    0.72336803787297349848896164841146460112,   -0.92327263044925080925477729510569699731,   0.016582846110455430851049450635630476598;
   -0.92327263044925080925477729510569699731,    -0.8000954074237226892341843533057676038,   0.016582846110455430851049450635630476598;
    -0.8000954074237226892341843533057676038,   -0.92327263044925080925477729510569699731,   0.016582846110455430851049450635630476598;
   -0.78754559055945991527489139589221510388,    0.35633147577927110921599545999123193124,   0.030890431288396919377481650650853417183;
    0.35633147577927110921599545999123193124,   -0.78754559055945991527489139589221510388,   0.030890431288396919377481650650853417183;
   -0.56878588521981119394110406409901682736,    0.35633147577927110921599545999123193124,   0.030890431288396919377481650650853417183;
    0.35633147577927110921599545999123193124,   -0.56878588521981119394110406409901682736,   0.030890431288396919377481650650853417183;
   -0.56878588521981119394110406409901682736,   -0.78754559055945991527489139589221510388,   0.030890431288396919377481650650853417183;
   -0.78754559055945991527489139589221510388,   -0.56878588521981119394110406409901682736,   0.030890431288396919377481650650853417183;
    -0.1599524823675518407071141661054621128,     0.1402893857819467195500916946480886286,    0.01478272600102119191287687445277038169;
     0.1402893857819467195500916946480886286,    -0.1599524823675518407071141661054621128,    0.01478272600102119191287687445277038169;
    -0.9803369034143948788429775285426265158,     0.1402893857819467195500916946480886286,    0.01478272600102119191287687445277038169;
     0.1402893857819467195500916946480886286,    -0.9803369034143948788429775285426265158,    0.01478272600102119191287687445277038169;
    -0.9803369034143948788429775285426265158,    -0.1599524823675518407071141661054621128,    0.01478272600102119191287687445277038169;
    -0.1599524823675518407071141661054621128,    -0.9803369034143948788429775285426265158,    0.01478272600102119191287687445277038169;
   -0.36427975232845596804806465673948070356,   0.084663608344856170859761688802646336641,   0.046766982927310947730184310937781849814;
   0.084663608344856170859761688802646336641,   -0.36427975232845596804806465673948070356,   0.046766982927310947730184310937781849814;
   -0.72038385601640020281169703206316563308,   0.084663608344856170859761688802646336641,   0.046766982927310947730184310937781849814;
   0.084663608344856170859761688802646336641,   -0.72038385601640020281169703206316563308,   0.046766982927310947730184310937781849814;
   -0.72038385601640020281169703206316563308,   -0.36427975232845596804806465673948070356,   0.046766982927310947730184310937781849814;
   -0.36427975232845596804806465673948070356,   -0.72038385601640020281169703206316563308,   0.046766982927310947730184310937781849814;
   -0.97852557428797782533895087798420844581,    0.41736275144064735566397781689608203229,   0.014312800953830741459725346431171736663;
    0.41736275144064735566397781689608203229,   -0.97852557428797782533895087798420844581,   0.014312800953830741459725346431171736663;
   -0.43883717715266953032502693891187358648,    0.41736275144064735566397781689608203229,   0.014312800953830741459725346431171736663;
    0.41736275144064735566397781689608203229,   -0.43883717715266953032502693891187358648,   0.014312800953830741459725346431171736663;
   -0.43883717715266953032502693891187358648,   -0.97852557428797782533895087798420844581,   0.014312800953830741459725346431171736663;
   -0.97852557428797782533895087798420844581,   -0.43883717715266953032502693891187358648,   0.014312800953830741459725346431171736663];

        w=M(:,3);
        xi=M(:,1:2)';
        %Transform the points to the standard triangle.
        v1=[-1,-1, 1;
            -1, 1,-1];
        v2=[1,0,0;
            0,1,0];
        [A,d]=affineTransBetweenTriangles(v1,v2);
        xi=bsxfun(@plus,A*xi,d);
        w=w/4;
    otherwise
        error('Unknown Algorithm Specified')
end
end

%LICENSE:
%
%The source code is in the public domain and not licensed or under
%copyright. The information and software may be used freely by the public.
%As required by 17 U.S.C. 403, third parties producing copyrighted works
%consisting predominantly of the material produced by U.S. government
%agencies must provide notice with such work(s) identifying the U.S.
%Government material incorporated and stating that such material is not
%subject to copyright protection.
%
%Derived works shall not identify themselves in a manner that implies an
%endorsement by or an affiliation with the Naval Research Laboratory.
%
%RECIPIENT BEARS ALL RISK RELATING TO QUALITY AND PERFORMANCE OF THE
%SOFTWARE AND ANY RELATED MATERIALS, AND AGREES TO INDEMNIFY THE NAVAL
%RESEARCH LABORATORY FOR ALL THIRD-PARTY CLAIMS RESULTING FROM THE ACTIONS
%OF RECIPIENT IN THE USE OF THE SOFTWARE.
